# Лекція 6. Частотні методи стеганографії
## Тема 2: Методи стеганографії на основі дискретного вейвлет-перетворення

### Вступ до вейвлет-перетворення в стеганографії

Дискретне вейвлет-перетворення (ДВП) представляє альтернативний підхід до аналізу зображень порівняно з дискретним косинусним перетворенням. Основна відмінність полягає в способі розкладання зображення: замість фіксованих блоків 8×8, ДВП використовує багатомасштабний аналіз з адаптивною локалізацією як у просторовій, так і в частотній областях.

Вейвлет-перетворення можна порівняти з розглядом зображення через систему лінз різної сили. Кожна лінза показує різний рівень деталізації: одна дає загальну картину, інша - середні деталі, третя - найдрібніші елементи. При цьому, на відміну від звичайного частотного аналізу, зберігається інформація про те, де саме на зображенні знаходяться ці деталі.

### 2.1. Принцип роботи вейвлет-перетворення

#### Багатомасштабний аналіз

ДВП розкладає зображення на компоненти різного масштабу подібно до того, як художник спочатку робить грубий ескіз, потім додає основні деталі, і нарешті - дрібні штрихи. Кожен рівень розкладання дає чотири типи інформації:

- **Апроксимація (LL)** - зменшена версія зображення
- **Горизонтальні деталі (LH)** - вертикальні краї та лінії
- **Вертикальні деталі (HL)** - горизонтальні краї та лінії
- **Діагональні деталі (HH)** - кути та текстури

#### Піраміда декомпозиції

Процес вейвлет-розкладання створює пірамідальну структуру. На першому рівні зображення ділиться на чотири частини розміром N/2 × N/2 кожна. Апроксимуюча частина (LL) може бути розкладена далі, створюючи другий рівень з частинами N/4 × N/4, і так далі.

Така структура має важливу властивість: основна енергія зображення концентрується в апроксимуючій частині (LL), тоді як деталізуючі частини містять переважно інформацію про краї та текстури. Це дозволяє ефективно вибирати місця для приховування даних.

### 2.2. Типи вейвлетів для стеганографії

#### Вейвлет Хаара

Найпростіший тип вейвлета, який використовує прямокутні функції. Працює за принципом обчислення середніх значень та різниць між сусідніми пікселями.

**Переваги для стеганографії:**
- Простота реалізації та швидкість обчислень
- Можливість використання цілочисельної арифметики
- Зворотне перетворення без втрат

**Недоліки:**
- Розривність базисної функції створює артефакти
- Погана локалізація в частотній області

#### Вейвлети Добеші

Сімейство ортогональних вейвлетів з компактним носієм. Чим вищий порядок вейвлета (db2, db4, db8), тим гладша базисна функція і краща частотна локалізація.

**Застосування в стеганографії:**
- db2 та db4 - баланс між складністю та ефективністю
- db8 та вище - для високоякісних водяних знаків

#### Біортогональні вейвлети

Використовують різні функції для декомпозиції та реконструкції, що дозволяє досягти симетричності та лінійної фази. Саме біортогональні вейвлети використовуються в стандарті стиснення JPEG2000.

**Особливості для стеганографії:**
- Симетричність зменшує крайові ефекти
- Краще зберігання країв зображення
- Сумісність з JPEG2000

### 2.3. Вбудовування даних в ДВП області

#### Вибір субдіапазонів для вбудовування

Різні субдіапазони мають різні характеристики для стеганографії:

**LL субдіапазон (апроксимація):**
- Містить основну енергію зображення
- Максимальна стійкість до спотворень
- Високий ризик візуальних артефактів
- Рідко використовується для стеганографії

**LH та HL субдіапазони (середні частоти):**
- Оптимальний баланс між стійкістю та непомітністю
- Містять інформацію про краї
- Основне місце для вбудовування даних
- Стійкість до стиснення та фільтрації

**HH субдіапазон (високі частоти):**
- Мінімальні візуальні спотворення
- Низька стійкість до обробки
- Підходить для крихких водяних знаків
- Часто обнуляється при стисненні

#### Методи модифікації коефіцієнтів

**Заміна молодшого біта (LSB):**
Найпростіший метод - заміна молодших бітів вейвлет-коефіцієнтів бітами повідомлення. Простий у реалізації, але вразливий до статистичного аналізу.

**Квантування з модуляцією (QIM):**
Коефіцієнти квантуються з різним кроком залежно від біта, що вбудовується. Метод забезпечує сліпе витягування (без оригіналу) та кращу стійкість.

**Адаптивне вбудовування:**
Сила вбудовування адаптується до локальних характеристик зображення. В текстурованих областях можна вбудовувати з більшою силою без візуальних артефактів.

### 2.4. Адаптивність на основі людського зору

#### Модель маскування

Людський зір має властивість маскування - в складних текстурованих областях зміни менш помітні. ДВП дозволяє ефективно використовувати це явище через аналіз локальної дисперсії коефіцієнтів.

**Принцип адаптивного вбудовування:**
1. Обчислення локальної текстурності для кожної області
2. Визначення порогу маскування на основі текстурності
3. Адаптація сили вбудовування до порогу
4. Максимальне вбудовування в текстуровані області

#### Вибір рівня декомпозиції

Оптимальний рівень декомпозиції залежить від розміру зображення та характеру контенту:

- **1-2 рівні** - для малих зображень або коли потрібна висока локалізація
- **3-4 рівні** - стандартний вибір для більшості застосувань
- **5 і більше рівнів** - для великих зображень з плавними переходами

Занадто глибока декомпозиція призводить до втрати просторової локалізації та ускладнює синхронізацію при витягуванні.

### 2.5. Порівняння ДВП з ДКП для стеганографії

#### Переваги ДВП

**Гнучкість представлення:**
ДВП дозволяє вибирати оптимальний масштаб аналізу для різних типів зображень. Великі однорідні області аналізуються на грубому рівні, дрібні деталі - на детальному.

**Відсутність блокових артефактів:**
На відміну від ДКП з фіксованими блоками 8×8, ДВП забезпечує плавні переходи між областями. Це особливо важливо при великих обсягах вбудованих даних.

**Природна ієрархія:**
Багаторівнева структура дозволяє реалізувати прогресивне вбудовування - від важливих даних на грубих рівнях до менш важливих на детальних.

#### Обмеження ДВП

**Обчислювальна складність:**
ДВП вимагає більше обчислень та пам'яті порівняно з блоковим ДКП. Необхідність буферизації всього зображення ускладнює обробку в реальному часі.

**Чутливість до геометричних спотворень:**
ДВП не має властивості інваріантності до зсуву. Навіть невеликий зсув або поворот зображення може зруйнувати приховані дані.

**Відсутність стандартизації:**
На відміну від JPEG з ДКП, немає єдиного стандарту використання ДВП для зображень (окрім JPEG2000, який поки не набув широкого поширення).

### 2.6. Практичні алгоритми на основі ДВП

#### Алгоритм Ксіа (Xia)

Один з перших практичних алгоритмів ДВП-стеганографії:
1. Виконується 3-рівневе ДВП з вейвлетом Хаара
2. Вибираються коефіцієнти субдіапазонів HL₃ та LH₃
3. Модифікуються середні біти коефіцієнтів
4. Використовується код корекції помилок для підвищення стійкості

Алгоритм забезпечує ємність близько 5% від розміру зображення та стійкість до JPEG стиснення з якістю Q>50.

#### Алгоритм Кундура-Хатзінакоса

Більш складний адаптивний алгоритм:
1. Повне ДВП зображення без обмеження рівнів
2. Відбір значущих коефіцієнтів за адаптивним порогом
3. Квантування коефіцієнтів з адаптивним кроком
4. Вбудовування через модуляцію індексу квантування

Особливість алгоритму - можливість витягування даних без оригінального зображення (сліпе витягування) та висока стійкість до різних видів обробки.

### 2.7. Стійкість та вразливості

#### Стійкість ДВП-методів

**До чого стійкі:**
- Стиснення з втратами (JPEG, JPEG2000) при правильному виборі коефіцієнтів
- Фільтрація низьких частот (розмиття)
- Додавання шуму низької інтенсивності
- Зміна яскравості та контрасту

**Фактори, що впливають на стійкість:**
- Вибір вейвлета (біортогональні стійкіші за Хаара)
- Рівень декомпозиції (глибші рівні стійкіші)
- Субдіапазон вбудовування (LL найстійкіший, HH найслабший)
- Сила вбудовування (компроміс з непомітністю)

#### Вразливості та методи виявлення

**Статистичні зміни:**
Коефіцієнти ДВП природних зображень мають характерний розподіл Лапласа (гострий пік в нулі, важкі хвости). Вбудовування даних змінює цей розподіл, що можна виявити статистичними тестами.

**Міжмасштабні залежності:**
Існують сильні кореляції між коефіцієнтами на різних рівнях декомпозиції. Стеганографія порушує ці залежності, що використовується для виявлення.

**Методи машинного навчання:**
Сучасні детектори витягують сотні статистичних ознак з різних субдіапазонів та рівнів, потім використовують класифікатори для виявлення прихованих даних.

### 2.8. Практичні рекомендації

#### Вибір параметрів для конкретних задач

**Для максимальної ємності:**
- Вейвлет Хаара (простота дозволяє використовувати більше коефіцієнтів)
- Всі субдіапазони крім LL
- Мінімальна кількість рівнів декомпозиції

**Для максимальної стійкості:**
- Біортогональні вейвлети
- LH та HL субдіапазони глибоких рівнів
- Велика сила вбудовування з корекцією помилок

**Для максимальної непомітності:**
- Вейвлети Добеші високого порядку
- Адаптивне вбудовування за текстурою
- HH субдіапазони та крайові області

#### Синхронізація та відновлення

Проблема синхронізації критична для ДВП-методів через відсутність інваріантності до зсуву. Рішення включають:

- Вбудовування синхронізаційних маркерів в LL субдіапазон
- Використання інваріантних точок зображення
- Пошук оптимального вирівнювання перебором
- Застосування стійких до зсуву вейвлет-перетворень

### Висновки

Методи стеганографії на основі дискретного вейвлет-перетворення надають потужний інструментарій для приховування інформації в зображеннях. Багатомасштабна природа ДВП дозволяє гнучко адаптуватися до характеристик зображення та вимог конкретної задачі.

Ключові переваги ДВП - відсутність блокових артефактів, природна ієрархічна структура та можливість точної адаптації до локальних характеристик - роблять ці методи особливо привабливими для систем цифрових водяних знаків та стеганографії високої якості.

Основні виклики включають обчислювальну складність, чутливість до геометричних спотворень та необхідність ретельного вибору параметрів. Успішне застосування ДВП-методів вимагає глибокого розуміння як математичних основ вейвлет-аналізу, так і практичних аспектів обробки зображень.

Майбутнє ДВП-стеганографії пов'язане з розвитком адаптивних методів, що використовують машинне навчання для оптимального вибору параметрів вбудовування, та з інтеграцією з новими стандартами стиснення зображень.

### Контрольні питання для самоперевірки

1. Поясніть основну відмінність між ДКП та ДВП з точки зору локалізації інформації.
2. Опишіть значення та характеристики чотирьох субдіапазонів (LL, LH, HL, HH) при вейвлет-декомпозиції.
3. Обґрунтуйте вибір LH та HL субдіапазонів як оптимальних для стеганографічного вбудовування.
4. Проаналізуйте вплив вибору типу вейвлета на характеристики стеганографічної системи.
5. Поясніть принцип адаптивного вбудовування на основі локальної текстурності.
6. Порівняйте стійкість ДВП-методів до різних видів атак та спотворень.
7. Опишіть основні методи забезпечення синхронізації при витягуванні даних з ДВП-області.