# Лекція 6. Частотні методи стеганографії
## Тема 3: Методи розширення спектру в стеганографії

### Вступ до технології розширення спектру

Методи розширення спектру (Spread Spectrum) прийшли в стеганографію з військових систем зв'язку, де вони використовувалися для захисту від перехоплення та глушіння сигналів. Основний принцип полягає в розподіленні інформаційного сигналу по широкій смузі частот, що робить його схожим на природний шум.

Аналогія з повсякденного життя: замість того, щоб кричати одне слово голосно (що привертає увагу), метод розширення спектру розподіляє це слово як ледь чутний шепіт по всій кімнаті. Кожен окремий звук майже нечутний, але той, хто знає, як їх зібрати разом, може відновити початкове повідомлення.

### 3.1. Принципи розширення спектру

#### Основна концепція

Традиційна передача даних використовує мінімально необхідну смугу частот - це ефективно, але вразливо. Розширення спектру навмисно використовує набагато ширшу смугу, ніж потрібно для передачі інформації. Надлишковість забезпечує стійкість та приховування.

**Ключові характеристики:**
- Сигнал розподіляється по широкій смузі частот
- Потужність сигналу на кожній частоті дуже мала
- Сигнал виглядає як шум для стороннього спостерігача
- Відновлення можливе тільки зі знанням секретного ключа

#### Виграш від обробки

Виграш від обробки (Processing Gain) - це відношення ширини смуги розширеного сигналу до ширини смуги інформаційного сигналу. Чим більший цей виграш, тим краще приховування та стійкість, але менша швидкість передачі даних.

Наприклад, при розширенні в 1000 разів:
- Сигнал стає в 1000 разів слабшим на кожній частоті
- Стійкість до перешкод зростає в 30 разів (10×log₁₀1000 ≈ 30 дБ)
- Швидкість передачі зменшується в 1000 разів

### 3.2. Типи систем розширення спектру

#### Пряме розширення спектру (DSSS)

Пряме розширення спектру (Direct Sequence Spread Spectrum) множить інформаційний сигнал на псевдовипадкову послідовність з набагато вищою частотою.

**Принцип роботи в стеганографії:**
1. Біт повідомлення перетворюється в послідовність +1 або -1
2. Множиться на довгу псевдовипадкову послідовність (чіп-код)
3. Результат додається до коефіцієнтів зображення з малою амплітудою
4. Розподілення по всьому зображенню забезпечує непомітність

**Приклад:**
- Один біт даних розширюється в 1024 чіпи
- Кожен чіп вбудовується в окремий піксель/коефіцієнт
- Амплітуда кожної зміни дуже мала (±1 рівень яскравості)
- При витягуванні 1024 слабких сигнали підсумовуються в один сильний

#### Стрибки по частотах (FHSS)

Метод стрибків по частотах (Frequency Hopping Spread Spectrum) передає інформацію, швидко перемикаючись між різними частотними каналами за псевдовипадковим законом.

**Застосування в стеганографії зображень:**
1. Зображення ділиться на частотні канали (субдіапазони)
2. Послідовність вбудовування визначається псевдовипадковим генератором
3. Кожен біт вбудовується в різний канал
4. Порядок каналів відомий тільки з ключем

**Переваги:**
- Складність виявлення через розподілення по різних частотах
- Стійкість до вузькосмугових перешкод
- Можливість уникнення пошкоджених областей

### 3.3. Псевдовипадкові послідовності

#### Роль псевдовипадкових послідовностей

Псевдовипадкові послідовності (ПВП) - це основа методів розширення спектру. Вони визначають, як саме розподіляється інформація по контейнеру. Якість ПВП критично впливає на безпеку та стійкість системи.

**Вимоги до ПВП для стеганографії:**
- Довгий період повторення (більше розміру зображення)
- Гарні кореляційні властивості (низька взаємна кореляція)
- Рівномірний розподіл значень
- Криптографічна стійкість (неможливість передбачення)

#### Типи генераторів ПВП

**Лінійні регістри зсуву (LFSR):**
Прості в реалізації, швидкі, але криптографічно слабкі. Підходять для систем, де безпека не критична, але важлива швидкість.

**m-послідовності:**
Максимальні послідовності від LFSR. Мають ідеальні автокореляційні властивості, що важливо для надійного витягування даних.

**Послідовності Голда:**
Спеціально розроблені для мінімальної взаємної кореляції. Дозволяють використовувати кілька незалежних каналів в одному зображенні.

**Криптографічні генератори:**
Використовують алгоритми шифрування (AES, ChaCha20) для генерації послідовностей. Максимальна безпека, але вища обчислювальна складність.

### 3.4. Вбудовування методом розширення спектру

#### Адитивне вбудовування

Найпростіший метод - додавання розширеного сигналу до зображення:

**Процес вбудовування:**
1. Генерація ПВП на основі секретного ключа
2. Модуляція ПВП бітами повідомлення (+1 для "1", -1 для "0")
3. Масштабування до малої амплітуди (параметр сили α)
4. Додавання до пікселів або частотних коефіцієнтів

**Вибір параметра сили α:**
- Малі значення (α < 1): висока непомітність, низька стійкість
- Середні значення (α = 1-5): оптимальний баланс
- Великі значення (α > 5): висока стійкість, помітні артефакти

#### Мультиплікативне вбудовування

Замість додавання, сигнал множиться на коефіцієнти зображення. Це забезпечує адаптивність - сильніші зміни в яскравих областях, слабші в темних.

**Переваги:**
- Природна адаптація до характеристик зображення
- Краща стійкість до зміни яскравості та контрасту
- Менша помітність в темних областях

**Недоліки:**
- Складніше витягування
- Чутливість до нелінійних спотворень

### 3.5. Витягування та детектування

#### Кореляційний детектор

Основний метод витягування - обчислення кореляції між зображенням та псевдовипадковою послідовністю.

**Процес витягування:**
1. Генерація тієї ж ПВП з секретним ключем
2. Обчислення кореляції між зображенням та ПВП
3. Порівняння результату з порогом
4. Прийняття рішення про значення біта

**Статистична надійність:**
При розширенні в N разів, відношення сигнал/шум покращується в √N разів. Наприклад, при N=1024, покращення становить 32 рази, що дозволяє надійно виявляти дуже слабкі сигнали.

#### Сліпе та інформоване витягування

**Інформоване витягування:**
Потребує оригінального зображення. Спочатку обчислюється різниця між оригіналом та стего-зображенням, потім застосовується кореляційний детектор. Забезпечує найвищу надійність.

**Сліпе витягування:**
Працює без оригіналу. Складніше через наявність "шуму" від самого зображення, але практичніше. Вимагає сильнішого вбудовування або довших ПВП.

**Напівсліпе витягування:**
Використовує статистичні характеристики оригіналу (середнє, дисперсія), але не саме зображення. Компроміс між надійністю та практичністю.

### 3.6. Стійкість методів розширення спектру

#### Стійкість до атак

**Стійкі до:**
- Додавання гаусового шуму (завдяки кореляційному накопиченню)
- JPEG стиснення (при вбудовуванні в стійкі частоти)
- Фільтрація (низькочастотна, медіанна)
- Незначні геометричні спотворення
- Зміна яскравості та контрасту

**Вразливі до:**
- Сильні геометричні трансформації (поворот, масштабування)
- Десинхронізуючі атаки
- Нелінійні спотворення (гамма-корекція)
- Вирізання частин зображення

#### Синхронізація

Проблема синхронізації критична для методів розширення спектру. Навіть невеликий зсув може зруйнувати кореляцію.

**Методи забезпечення синхронізації:**

**Вбудовування пілот-сигналу:**
Спеціальна синхронізаційна послідовність вбудовується паралельно з даними. При витягуванні спочатку знаходиться пілот-сигнал, потім відновлюється синхронізація.

**Використання інваріантних доменів:**
Вбудовування в області, інваріантні до певних трансформацій (логарифмічно-полярні координати для стійкості до повороту та масштабування).

**Вичерпний пошук:**
Перебір можливих зсувів та трансформацій до знаходження максимальної кореляції. Обчислювально витратно, але надійно для невеликих спотворень.

### 3.7. Порівняння з іншими методами

#### Переваги розширення спектру

**Висока стійкість:**
Розподілення інформації по всьому зображенню забезпечує стійкість до локальних пошкоджень. Навіть при втраті 50% зображення часто можливо відновити повідомлення.

**Складність видалення:**
Без знання ПВП практично неможливо видалити вбудовані дані, не зруйнувавши зображення.

**Статистична непомітність:**
При малій амплітуді вбудований сигнал статистично не відрізняється від природного шуму зображення.

#### Недоліки та обмеження

**Мала ємність:**
Через великий коефіцієнт розширення, ємність значно менша порівняно з LSB або QIM методами. Типова ємність - 0.01-0.1% від розміру контейнера.

**Обчислювальна складність:**
Потребує обробки всього зображення для кожного біта. Кореляційне детектування також обчислювально витратне.

**Проблеми синхронізації:**
Чутливість до геометричних спотворень вимагає додаткових механізмів синхронізації, що ускладнює систему.

### 3.8. Практичні системи та застосування

#### Системи цифрових водяних знаків

Розширення спектру ідеально підходить для стійких водяних знаків:
- Захист авторських прав
- Автентифікація документів
- Відстеження розповсюдження контенту
- Прихована анотація мультимедіа

**Комерційні системи:**
Digimarc, DataMark Technologies та інші компанії використовують варіанти розширення спектру для промислових систем водяних знаків.

#### Комбіновані підходи

**Гібрид з частотними методами:**
Вбудовування розширеного сигналу в певні частотні діапазони (середні частоти DCT або DWT). Поєднує переваги обох підходів.

**Багаторівневе вбудовування:**
Використання різних ПВП для різних рівнів важливості даних. Критичні дані вбудовуються з більшим розширенням та силою.

**Адаптивне розширення:**
Коефіцієнт розширення адаптується до локальних характеристик зображення. Більше розширення в складних областях, менше - в простих.

### 3.9. Стегоаналіз методів розширення спектру

#### Статистичні методи виявлення

Хоча розширений сигнал схожий на шум, він має певні статистичні відмінності від природного шуму зображення:

**Підвищення дисперсії:**
Додавання псевдовипадкового сигналу збільшує дисперсію шуму. При достатній кількості зображень можна виявити аномальне збільшення.

**Кореляційні аномалії:**
Природний шум зображення має певну просторову кореляцію. Додавання некорельованого ПВП сигналу порушує цю структуру.

**Спектральні сліди:**
Розширений сигнал може залишати характерні сліди в спектрі потужності, особливо при використанні простих ПВП.

#### Методи протидії стегоаналізу

**Формування шуму:**
Замість простого додавання, ПВП сигнал формується так, щоб імітувати статистику природного шуму.

**Адаптивна сила:**
Автоматичне регулювання сили вбудовування для підтримки природної статистики.

**Використання природного шуму:**
Модифікація існуючого шуму зображення замість додавання нового.

### Висновки

Методи розширення спектру представляють унікальний підхід до стеганографії, що жертвує ємністю заради стійкості та безпеки. Розподілення інформації по всьому зображенню з використанням псевдовипадкових послідовностей забезпечує виняткову стійкість до різноманітних атак та спотворень.

Основна сила методів розширення спектру - в їх статистичній природі. Накопичення слабких сигналів дозволяє надійно витягувати інформацію навіть з сильно спотворених зображень. Це робить їх ідеальними для застосувань, де стійкість критичніша за ємність.

Головні виклики включають малу пропускну здатність, проблеми синхронізації та обчислювальну складність. Проте для багатьох практичних застосувань, особливо цифрових водяних знаків, ці обмеження прийнятні.

Майбутній розвиток методів розширення спектру пов'язаний з адаптивними схемами, що динамічно регулюють параметри вбудовування, та з інтеграцією з іншими стеганографічними техніками для створення гібридних систем з оптимальним балансом характеристик.

### Контрольні питання для самоперевірки

1. Поясніть основний принцип розширення спектру та його переваги для стеганографії.
2. Опишіть різницю між прямим розширенням спектру (DSSS) та стрибками по частотах (FHSS).
3. Проаналізуйте роль псевдовипадкових послідовностей у забезпеченні безпеки системи.
4. Поясніть принцип роботи кореляційного детектора та статистичне накопичення сигналу.
5. Обґрунтуйте компроміс між ємністю та стійкістю в методах розширення спектру.
6. Опишіть основні підходи до вирішення проблеми синхронізації.
7. Порівняйте ефективність розширення спектру з LSB та частотними методами для різних застосувань.