# Лекція 6. Частотні методи стеганографії
## Тема 4: Методи квантової індексної модуляції (QIM)

### Вступ до квантової індексної модуляції

Квантова індексна модуляція (Quantization Index Modulation, QIM) представляє теоретично обґрунтований підхід до стеганографії, базований на принципах теорії інформації. Метод використовує процес квантування - перетворення неперервних значень у дискретні - для вбудовування інформації.

Основна ідея QIM полягає в використанні різних квантувачів для різних значень даних. Замість безпосередньої модифікації сигналу, метод вибирає один з кількох можливих способів квантування залежно від біта, що вбудовується. Це забезпечує передбачуваність змін та можливість надійного витягування даних без оригіналу.

### 4.1. Теоретичні основи QIM

#### Принцип квантування

Квантування - це процес округлення неперервних значень до найближчих дискретних рівнів. У повсякденному житті це подібно до округлення цін до найближчої гривні або вимірювання часу з точністю до хвилини замість секунд.

**Основні параметри квантування:**
- **Крок квантування (Δ)** - відстань між сусідніми рівнями
- **Рівні квантування** - дискретні значення, до яких округлюється сигнал
- **Функція квантування** - правило вибору найближчого рівня
- **Помилка квантування** - різниця між оригінальним та квантованим значенням

#### Модуляція індексом квантування

QIM використовує набір квантувачів, кожен з яких відповідає певному значенню даних. Для бінарного випадку використовуються два квантувачі:
- Q₀ для вбудовування біта "0"
- Q₁ для вбудовування біта "1"

Ці квантувачі зсунуті один відносно одного на половину кроку квантування. При вбудовуванні вибирається відповідний квантувач, при витягуванні визначається, який квантувач дає менше відхилення.

### 4.2. Базовий алгоритм QIM

#### Скалярне квантування

Найпростіша форма QIM працює з окремими значеннями (скалярами):

**Процес вбудовування:**
1. Вибір кроку квантування Δ
2. Створення двох наборів рівнів квантування:
    - Для біта "0": {..., -2Δ, 0, 2Δ, 4Δ, ...}
    - Для біта "1": {..., -Δ, Δ, 3Δ, 5Δ, ...}
3. Квантування коефіцієнта до найближчого рівня з відповідного набору
4. Заміна оригінального коефіцієнта квантованим значенням

**Процес витягування:**
1. Визначення найближчих рівнів з обох наборів
2. Обчислення відстаней до цих рівнів
3. Вибір набору з меншою відстанню
4. Відновлення біта за вибраним набором

#### Векторне квантування

Векторне QIM працює з групами коефіцієнтів одночасно, що дозволяє досягти кращої ефективності:

**Переваги векторного підходу:**
- Краще використання кореляції між коефіцієнтами
- Менші спотворення при тій же ємності
- Можливість вбудовування більше інформації
- Складніша структура для аналізу зловмисником

**Недоліки:**
- Вища обчислювальна складність
- Потреба в більших таблицях квантування
- Складність оптимізації параметрів

### 4.3. Модифікації та покращення QIM

#### Dither модуляція (DM-QIM)

Dither модуляція додає псевдовипадковий сигнал (dither) перед квантуванням для покращення статистичних властивостей:

**Процес з dither:**
1. Генерація псевдовипадкового dither-вектора d
2. Додавання dither до сигналу: x' = x + d
3. Квантування модифікованого сигналу
4. Віднімання dither від результату

**Переваги dither модуляції:**
- Усунення систематичної помилки квантування
- Покращення статистичної непомітності
- Розподілення помилки квантування
- Зменшення кореляції між сигналом та шумом квантування

#### Адаптивний QIM

Адаптивні схеми регулюють крок квантування залежно від локальних характеристик сигналу:

**Принципи адаптації:**
- Більший крок у текстурованих областях (менш помітні зміни)
- Менший крок у гладких областях (збереження якості)
- Врахування перцептуальної моделі людського зору
- Динамічне балансування між ємністю та якістю

**Методи визначення кроку:**
- На основі локальної дисперсії
- З використанням частотного аналізу
- Через машинне навчання
- За допомогою попереднього аналізу контенту

### 4.4. Distortion-Compensated QIM (DC-QIM)

#### Компенсація спотворень

DC-QIM враховує очікувані спотворення при передачі та компенсує їх на етапі вбудовування:

**Модель спотворень:**
Система моделює типові спотворення (стиснення, фільтрація, шум) та оптимізує квантування для мінімізації їх впливу.

**Предискорсія:**
Навмисне зміщення рівнів квантування в напрямку, протилежному очікуваним спотворенням. Після проходження через канал з спотвореннями, сигнал наближається до оптимальних позицій.

**Ітеративна оптимізація:**
1. Початкове квантування
2. Симуляція спотворень
3. Оцінка помилки витягування
4. Корекція параметрів квантування
5. Повторення до досягнення оптимуму

### 4.5. Порівняння QIM з LSB

#### Переваги QIM над LSB

**Теоретична оптимальність:**
QIM досягає кращого компромісу між ємністю, спотвореннями та стійкістю згідно з теорією інформації. При однакових спотвореннях QIM може вбудувати більше інформації.

**Передбачуваність спотворень:**
На відміну від LSB, де зміна може бути ±1, QIM дає передбачувану максимальну зміну ≤ Δ/2. Це дозволяє краще контролювати якість.

**Стійкість до обробки:**
QIM природно стійкий до додавання шуму амплітудою менше Δ/4, тоді як LSB руйнується від будь-якого шуму.

#### Недоліки QIM

**Складність реалізації:**
QIM вимагає ретельного вибору параметрів та може потребувати ітеративної оптимізації, тоді як LSB тривіально простий.

**Чутливість до параметрів:**
Неправильний вибір кроку квантування може суттєво погіршити як якість, так і надійність витягування.

**Обчислювальні витрати:**
Особливо для векторного QIM та адаптивних схем, обчислювальна складність значно вища за LSB.

### 4.6. Застосування в різних доменах

#### QIM в просторовій області

Безпосереднє застосування до пікселів зображення:

**Особливості:**
- Простота реалізації
- Висока ємність
- Помітність змін у гладких областях
- Чутливість до будь-якої обробки

**Покращення:**
- Адаптивний вибір пікселів
- Використання крайових областей
- Комбінація з перцептуальними масками

#### QIM в частотній області

Застосування до коефіцієнтів DCT, DWT або DFT:

**Переваги частотного QIM:**
- Краща непомітність через вибір середніх частот
- Природна стійкість до стиснення
- Можливість використання психовізуальних моделей
- Інтеграція зі стандартами стиснення

**Оптимальні коефіцієнти:**
- AC коефіцієнти середніх частот для DCT
- LH та HL субдіапазони для DWT
- Коефіцієнти з достатньою енергією

### 4.7. Стійкість та атаки

#### Стійкість QIM до різних спотворень

**Стійкий до:**
- Додавання шуму малої амплітуди (< Δ/4)
- Лінійна фільтрація з невеликими коефіцієнтами
- Квантування з кроком, кратним Δ
- Незначні зміни яскравості та контрасту

**Вразливий до:**
- Сильний адитивний шум (> Δ/2)
- Нелінійні спотворення (гамма-корекція)
- Геометричні трансформації
- Повторне квантування з некратним кроком

#### Атаки на QIM

**Атака оцінкою кроку:**
Зловмисник намагається визначити крок квантування через аналіз гістограми коефіцієнтів. Після визначення Δ можлива модифікація або видалення даних.

**Протидія:**
- Використання змінного кроку
- Додавання dither для маскування
- Адаптивне квантування

**Атака додаванням шуму:**
Додавання випадкового шуму амплітудою ≈ Δ/2 може зруйнувати вбудовані дані.

**Протидія:**
- Коди корекції помилок
- Повторне кодування
- Збільшення кроку квантування

### 4.8. Практична реалізація

#### Вибір параметрів

**Крок квантування Δ:**
Ключовий параметр, що визначає компроміс між якістю та стійкістю:
- Малий крок (Δ < 5): висока якість, низька стійкість
- Середній крок (Δ = 5-15): оптимальний баланс
- Великий крок (Δ > 15): низька якість, висока стійкість

**Правила вибору:**
1. Аналіз типового рівня шуму в зображенні
2. Встановлення Δ ≈ 4×σ_noise для надійності
3. Адаптація до локальних характеристик
4. Тестування на репрезентативній вибірці

#### Синхронізація та маркування

**Проблема синхронізації:**
Необхідність точного визначення позицій квантованих коефіцієнтів при витягуванні.

**Рішення:**
- Фіксований порядок обходу коефіцієнтів
- Вбудовування синхро-маркерів
- Використання стійких точок зображення
- Redundant embedding критичних даних

### 4.9. Розширені схеми QIM

#### Rational Dither Modulation (RDM)

Використання раціональних чисел для dither дозволяє точніше контролювати розподіл помилки квантування:

**Особливості:**
- Dither вибирається з раціональної решітки
- Кращий контроль статистичних властивостей
- Можливість точного відновлення при відсутності шуму
- Складність вибору оптимальної решітки

#### Spread Transform Dither Modulation (STDM)

Комбінація QIM з розширенням спектру:

**Принцип:**
1. Проекція сигналу на псевдовипадковий вектор
2. Квантування проекції методом QIM
3. Зворотна проекція для отримання модифікованого сигналу
4. Розподілення змін по багатьох коефіцієнтах

**Переваги:**
- Висока стійкість до локальних спотворень
- Складність аналізу для зловмисника
- Гнучкість у виборі компромісів

### 4.10. Стегоаналіз QIM

#### Статистичні методи виявлення

**Аналіз розподілу коефіцієнтів:**
QIM створює характерні "сходинки" в гістограмі через квантування. Ці артефакти можуть бути виявлені статистичними тестами.

**Кластерний аналіз:**
Квантовані значення групуються навколо рівнів квантування, створюючи кластерну структуру, відсутню в природних зображеннях.

**Спектральний аналіз:**
Періодичність рівнів квантування може проявлятися в спектрі потужності коефіцієнтів.

#### Машинне навчання для виявлення QIM

**Ознаки для детектування:**
- Статистики гістограми (моменти, ентропія)
- Відстані між сусідніми коефіцієнтами
- Локальна варіабельність
- Кореляційні характеристики

**Класифікатори:**
- SVM з радіальним ядром
- Випадкові ліси
- Глибокі нейронні мережі

Сучасні детектори досягають точності >90% для типових параметрів QIM при достатньому обсязі навчальних даних.

### Висновки

Квантова індексна модуляція представляє теоретично обґрунтований та практично ефективний метод стеганографії. Використання принципів квантування забезпечує передбачуваність спотворень та можливість оптимізації компромісу між різними характеристиками системи.

Ключова перевага QIM - його теоретична база, що дозволяє аналітично оцінювати продуктивність та оптимізувати параметри. На відміну від евристичних методів типу LSB, QIM має строге математичне обґрунтування в рамках теорії інформації.

Основні виклики включають складність вибору оптимальних параметрів, чутливість до типу та сили спотворень, та наявність статистичних артефактів, що полегшують виявлення. Проте численні модифікації та розширення базового методу дозволяють адаптувати QIM до конкретних вимог застосування.

Майбутній розвиток QIM пов'язаний з адаптивними схемами, що використовують машинне навчання для оптимізації параметрів, та з комбінуванням з іншими методами для створення гібридних систем з покращеними характеристиками.

### Контрольні питання для самоперевірки

1. Поясніть основний принцип квантової індексної модуляції та роль різних квантувачів.
2. Опишіть процеси вбудовування та витягування даних у базовому алгоритмі QIM.
3. Проаналізуйте переваги використання dither модуляції порівняно з базовим QIM.
4. Обґрунтуйте теоретичні переваги QIM над методом заміни молодших бітів.
5. Поясніть принципи адаптивного вибору кроку квантування.
6. Опишіть основні типи атак на QIM та методи протидії їм.
7. Порівняйте ефективність QIM у просторовій та частотній областях.